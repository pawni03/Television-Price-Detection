getwd()
tv_data=read.csv("TELEVISION.csv")
table(tv_data$Stars)
tv_data=tv_data[-c(597,367,276),]
tv_data$current_price=as.numeric(gsub("\\₹","",tv_data$current_price))
tv_data$MRP=as.numeric(gsub("\\₹","",tv_data$MRP))
tv_data$Product_Name=factor(tv_data$Product_Name)
tv_data$Product_Name=as.numeric(tv_data$Product_Name)
tv_data$channel=factor(tv_data$channel)
tv_data$channel=as.numeric(tv_data$channel)
tv_data$Operating_system=factor(tv_data$Operating_system)
tv_data$Operating_system=as.numeric(tv_data$Operating_system)
tv_data$Stars=factor(tv_data$Stars)
tv_data$Stars=as.numeric(tv_data$Stars)
tv_data$Picture_qualtiy=factor(tv_data$Picture_qualtiy)
tv_data$Picture_qualtiy=as.numeric(tv_data$Picture_qualtiy)
tv_data$Speaker=factor(tv_data$Speaker)
tv_data$Speaker=as.numeric(tv_data$Speaker)
tv_data$Frequency=factor(tv_data$Frequency)
tv_data$Frequency=as.numeric(tv_data$Frequency)
tv_data$Image_url=factor(tv_data$Image_url)
tv_data$Image_url=as.numeric(tv_data$Image_url)
any(is.na(tv_data))

cor(tv_data$current_price,tv_data$Product_Name)
cor(tv_data$current_price,tv_data$Ratings)
cor(tv_data$current_price,tv_data$Reviews)
cor(tv_data$current_price,tv_data$MRP)
cor(tv_data$current_price,tv_data$channel)
cor(tv_data$current_price,tv_data$Operating_system)
cor(tv_data$current_price,tv_data$Ratings)
cor(tv_data$current_price,tv_data$Picture_qualtiy)
cor(tv_data$current_price,tv_data$Speaker)
cor(tv_data$current_price,tv_data$Frequency)
cor(tv_data$current_price,tv_data$Image_url)

sample=sample.split(tv_data$current_price,SplitRatio=0.7)
trainingset=subset(tv_data,sample==TRUE)
testset=subset(tv_data,sample==FALSE)
model=lm(current_price~.,data=trainingset)
testset$predictedprice=predict(model,testset)
cor(testset$current_price,testset$predictedprice)

